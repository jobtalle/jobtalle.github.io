<!DOCTYPE html><html lang="en"><head><title>Job Talle | Neuroevolution in squids</title><meta charset="UTF-8"><meta name="description" content="Artificial neural networks can be trained to perform certain tasks, but they can also be the product of simulated evolution. Evolved nervous systems are created according to a genetic blueprint. This article demonstrates squids swimming efficiently using tentacles controlled by an evolved neural network."/><meta name="keywords" content="software development, AI, algorithms, programming, Job Talle"/><meta name="author" content="Job Talle"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:locale" content="en_US"/><meta property="og:title" content="Neuroevolution in squids"/><meta property="og:url" content="https://jobtalle.com/neuroevolution_in_squids.html"/><meta property="og:description" content="Artificial neural networks can be trained to perform certain tasks, but they can also be the product of simulated evolution. Evolved nervous systems are created according to a genetic blueprint. This article demonstrates squids swimming efficiently using tentacles controlled by an evolved neural network."/><meta property="og:image" content="https://jobtalle.com/posts/2020_4_24/img/preview.jpg"/><meta property="twitter:image" content="https://jobtalle.com/posts/2020_4_24/img/preview.jpg"/><meta property="twitter:description" content="Artificial neural networks can be trained to perform certain tasks, but they can also be the product of simulated evolution. Evolved nervous systems are created according to a genetic blueprint. This article demonstrates squids swimming efficiently using tentacles controlled by an evolved neural network."/><meta property="twitter:site" content="jobtalle.com"/><meta property="twitter:card" content="summary"/><meta property="twitter:title" content="Neuroevolution in squids"/><link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet"/><link rel="shortcut icon" type="image/gif" href="img/favicon.gif"/><link rel="stylesheet" type="text/css" href="css/style.css"/><link rel="stylesheet" href="lib/katex/katex.min.css"></head><body><div id="container"><div id="menu-wrapper"><div class="menu-button" id="menu-toggle" onclick="document.getElementById('menu-buttons').classList.toggle('visible')"><div class="burger-slice"></div><div class="burger-slice"></div><div class="burger-slice"></div></div><div id="menu-buttons"><a href="index.html"><div class="menu-button">Blog</div></a><a href="sketches.html"><div class="menu-button">Sketches</div></a><a href="games.html"><div class="menu-button">Games</div></a><a href="work.html"><div class="menu-button">Work</div></a><a href="about.html"><div class="menu-button">About</div></a><a href="contact.html"><div class="menu-button">Contact</div></a></div></div><div id="wrapper" class="container"><div id="header"><h1>Job Talle</h1><h2>On AI, Art & Algorithms</h2></div><div id="content"><h1>Neuroevolution in squids</h1><span class="date">24 Apr 2020</span><h2>Evolving a neural network</h2><p>Artificial neural networks mimic real biological nervous systems. They contain neurons and connections between them to transform input signals into meaningful output. In the field of machine learning, these networks are often initialized with random connections between the neurons, after which the network is <em>trained</em> until it behaves in a useful way. This works well enough, but many simple nervous systems found in animals work "out of the box"; no one teaches a fish to swim or butterflies to fly, even though their behaviour is produced by networks of neurons. Their nervous systems are not products of random initialization and subsequent training, but of <em>evolution</em>. After many generations, nature has produced an arrangement of cells and connections producing complex and useful behaviour.</p><p>To produce neural networks that produce non-learned behaviour, <em>neuroevolution</em> can be used. Evolutionary algorithms (like <a href="https://jobtalle.com/evolving_lindenmayer_systems.html" target="_blank">the one I used to evolve plants</a>) evolve a genetic code over time. The genetic code (a model for DNA) and the organism it represents starts out very simple, but over the course of many generations small mutations add beneficial complexity and functions promoting further propagation of these properties.</p><h2>Digital squids</h2><p>To demonstrate neuroevolution, I want to evolve digital squids. The squids have the following properties:</p><figure title="A digital squid"><img src="posts/2020_4_24/img/squid.gif"><figcaption>Figure 1: A swimming squid.</figcaption></figure><ul><li>They can have any number of tentacles with varying length.</li><li>Each arm is controlled by a single output neuron, swinging them to one direction when low output is produced and in the opposite direction when high output is produced.</li><li>Squids have <em>heads</em>, the size of the head determines the amount of neurons it may have.</li><li>The mass of a squid is determined by its head size and number of tentacle segments.</li><li>Squids swim in simulated liquid filled with dots representing food. Touching these dots "eats" them, and the score of a squid is the number of dots it eats divided by its mass.</li></ul><p>These properties should through evolution produce squids that can swim efficiently through an environment, eating as much food as possible. Because they have mass as well, squid bodies must be effective: heavy bodies and big tentacles require more food, there must be a good reason to evolve them.</p><p>Because the squid can have varying properties (like head size and the configuration of its tentacles), these properties evolve as well. The <em>DNA</em> of a squid does not only contain the blueprint for its brain, but also its body plan.</p><p>Figure 1 shows a simulated squid with two arms. The curling motion of the arms is achieved by adding a spring strength to the arm segments; if the muscles would stop moving the arms, the segments would slowly align until the arms are straight lines. To calculate the amount of acceleration, all lateral motion is summed. In the figure, all the sideways motion of the red lines would make up this number. By swinging tentacles behind its body, the squid achieves forward motion.</p><h2>Spiking neural networks</h2><p>Choosing the right neural network for the job at hand is tricky. There are many different flavours of neural networks, <a href="https://towardsdatascience.com/the-mostly-complete-chart-of-neural-networks-explained-3fb6f2367464" target="_blank">this chart</a> contains a nice overview of some of them. The neural networks controlling the squids are in some aspects not like most well known networks:</p><ul><li>They do not have a traditional input to output structure. In fact, they do not need to contain input neurons at all. While many traditional neural networks transform or classify input in a way, the squid networks should produce behaviour.</li><li>The squid neurons need to work in <em>real-time</em>. There is no question to answer structure, the networks should function continually.</li><li>Because the networks evolve over time, they have no preset structure or size. The number of neurons and the number of connections between them varies according to their DNA, and changes over generations.</li></ul><p>A <em><a href="https://en.wikipedia.org/wiki/Spiking_neural_network" target="_blank">spiking neural network</a></em> fits these requirements. They operate in real-time, and were designed to mimic nature more closely. Just like real neurons, cells in a spiking neural network build up potential gathered from all its inputs over time, and slowly return to their "neutral" state when no input is received. Spiking neural networks do not need to adhere to a strict connectivity scheme. They consist of a layer of input neurons, a layer of output neurons (controlling the tentacles in our case) and a number of neurons in between, called the <em>hidden layer</em>. Neurons in the hidden layer may be connected to input and output neurons, but neurons may be disconnected as well. For this application, neurons within the hidden layer may be connected to each other.</p><figure title="The logistic function"><img src="posts/2020_4_24/img/sigmoid.png"><figcaption>Figure 2: The logistic function.</figcaption></figure><p>The neurons in the nervous systems all have an <em>activation function</em>. This function determines the output value of the neuron based on the sum of its inputs. Neurons are connected by <em>axons</em>, which connect a source to a target neuron. The axon adds the source output value multiplied by the <em>axon weight</em> (which can be a positive or negative number) to the target activation. The activation function then determines the neuron output based on its activation. The chosen activation function in this simulation is the <em>logistic function:</em></p><p>$$\frac{1}{1+e^{-a}}$$</p><p>In this equation, $a$ is the activation of the neuron. Figure 2 shows a plot of the function. When $a=0$, the output is $0.5$; this is useful in this simulation, because the network must be able to produce behaviour even when no input is given. If the default output is non zero, some signals always flow through the system. The value of $a$ can in theory be very small or very large, but the asymptotes of the logistic function ensure that the output value is always in the range $[0, 1]$. In this way, extreme output values will not propagate through the system.</p><h2>Simulating evolution</h2><p>The simulation environment consists of the following components:</p><ul><li>Any number of squids with varying body plans and a spiking neural network to control its limbs.</li><li>Food scattered around the environment.</li></ul><p>To start simulating evolution, the simulation simulates a fixed amount of time per generation. In my simulations, I chose time periods of 20 to 30 seconds. After this time, the best performing squid is picked and duplicated several times to form a new generation of squids. Before the next simulation takes place, all squids are mutated slightly. The following properties may mutate:</p><ul><li>Body radius, and with that the maximum number of allowed neurons in the squid brain.</li><li>The number and location of tentacles.</li><li>The length of the tentacles.</li><li>The number of neurons in the brain.</li><li>The axon connections between the neurons (connections may appear and disappear, and connection weights may increase or decrease).</li></ul><p>For now, the squid brains contain no input neurons. The number of output neurons is always equal to the number of tentacles, and every tentacle is assigned one output neuron. When a tentacle mutates away, its corresponding output neuron is deleted as well. When a new tentacle is mutated, it receives a new randomly connected output neuron.</p><p>The source code for the simulation is <a href="https://github.com/jobtalle/Cephalopods" target="_blank">on GitHub</a>, and the simulation <a href="https://jobtalle.com/Cephalopods/" target="_blank">runs in a browser</a>.</p><h2>Results</h2><figure title="Pulsating neurons"><img src="posts/2020_4_24/img/neurons.gif"><figcaption>Figure 3: A nervous system producing indefinite pulses.</figcaption></figure><p>Running the simulation usually results in moving squids within several hundreds of generations. When a working swimming strategy evolves, it will usually evolve into the most optimal version of itself over time.</p><p>The nervous systems can be visualized. Figure 3 shows a simple nervous system of a squid with two arms. The network contains five neurons represented by orange dots, and two output neurons represented by blue dots. When neuron output rises, neurons be come more colourful. When output decreases, the dots become transparent. Axons are visualized by dotted lines between the neurons they connect. When an axon transports a signal (and influences the target neuron), the dotted line becomes more visible while the dots move in the signal direction.</p><figure title="Swimming evolved squids"><img src="posts/2020_4_24/img/swimming.gif"><figcaption>Figure 4: Evolved swimming squids. Note that not all agents are very efficient; some contain unhelpful mutations.</figcaption></figure><p>Figure 4 shows several squids swimming around in a simulation environment. These squids swim using two tentacles that swing simultaneously. Some variety among the agents can be seen:</p><ul><li>Tentacle length varies, but their movement patterns are roughly equal.</li><li>Two agents in the lower half have evolved extra tentacles that don't do much at this point. They will add mass to the squid, making them perform worse.</li></ul><h2>Conclusion</h2><p>The simulation at its current state demonstrates the effectiveness of neuroevolution, and forms a basis for several extensions:</p><ul><li>Sensors may be added to the squids. One or more eyes could produce signals that may steer a squid towards food sources or away from competitors.</li><li>Other output organs could be created as well. Simple arms could move or push food around, and ink sacs can cloud the vision of nosy competitors.</li><li>Larger environments can be created where squids only reproduce in their neighbourhood to allow multiple different species to evolve and exist simultaneously.</li><li>Generations can be simulated for longer periods of time. Currently, the behaviour can be interpreted as a race to get all the food quickly and efficiently. This requires speed, but no complex maneuvers. If food grows over time, or moves with a current, much more elaborate strategies are required.</li></ul><p>These additions would not require any changes to the basic mechanism of neuroevolution, they just allow for more different strategies to emerge. The versatility and adaptivity of the demonstrated neuroevolution framework makes it an interesting tool for many other applications, especially those focusing on <em>artificial life</em>.</p><div id="references"><a href="layered_voxel_rendering.html" title="Previously: Layered voxel rendering"><div class="post-reference post-reference-left">Layered voxel rendering</div></a><a href="simulating_hydraulic_erosion.html" title="Up next: Simulating hydraulic erosion"><div class="post-reference post-reference-right">Simulating hydraulic erosion</div></a></div></div><div id="footer">&copy Job Talle 2017 - 2025</div><div id="icons"><a href="contact.html"><div class="icon" id="icon-mail" title="Mail"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="283.46px" height="283.46px" viewBox="0 0 283.46 283.46"><path class="icon-body" d="M141.73,0C63.451,0,0,63.451,0,141.73C0,220,63.451,283.46,141.73,283.46 c78.279,0,141.73-63.461,141.73-141.73C283.46,63.451,220.009,0,141.73,0z"/><g fill="#FFF"><polygon points="57.737,193.24 103.702,135.45 57.737,107.352"/><polygon points="172.734,139.48 141.632,158.63 110.479,139.586 62.981,199.308 220.275,199.308"/><polygon points="141.624,149.382 225.722,97.59 225.722,84.152 57.737,84.152 57.737,98.113"/><polygon points="179.492,135.317 225.722,193.488 225.722,106.847"/></g></svg></div></a><a href="https://orcid.org/0000-0003-1946-8407" target="_blank"><div class="icon" title="ORCID"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 283.46 283.46" width="283.46" height="283.46" version="1.1"><path class="icon-body" d="m141.73,0c-78.275,0 -141.73,63.455 -141.73,141.73c0,78.275 63.455,141.73 141.73,141.73c78.275,0 141.73,-63.455 141.73,-141.73c0,-78.275 -63.455,-141.73 -141.73,-141.73z"/><g transform="matrix(1.107422241811154,0,0,1.107422241811154,10.99953146307012,219.93852396886876)" fill="#FFF"><path d="m76.36744,-12.40403l-15.4,0l0,-107.1l15.4,0l0,48.4l0,58.7z"/><path d="m98.96744,-119.50403l41.6,0c39.6,0 57,28.3 57,53.6c0,27.5 -21.5,53.6 -56.8,53.6l-41.8,0l0,-107.2zm15.4,93.3l24.5,0c34.9,0 42.9,-26.5 42.9,-39.7c0,-21.5 -13.7,-39.7 -43.7,-39.7l-23.7,0l0,79.4z"/><path d="m78.76744,-141.80403c0,5.5 -4.5,10.1 -10.1,10.1c-5.6,0 -10.1,-4.6 -10.1,-10.1c0,-5.6 4.5,-10.1 10.1,-10.1c5.6,0 10.1,4.6 10.1,10.1z"/></g></svg></div></a><a href="https://www.github.com/jobtalle" target="_blank"><div class="icon" title="Github"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="283.46px" height="283.46px" viewBox="0 0 283.46 283.46"><path class="icon-body" d="M141.73,0C63.455,0,0,63.455,0,141.73c0,78.275,63.455,141.73,141.73,141.73 c78.275,0,141.73-63.455,141.73-141.73C283.46,63.455,220.005,0,141.73,0z"/><path fill="#FFF" d="M170.925,222.189H149.49h-21.455c0,0,0.062-12.73,0-21.455 c-29.36,6.324-37.554-16.091-37.554-16.091c-5.359-10.731-10.732-16.091-10.732-16.091c-10.731-6.369,0-5.359,0-5.359 c10.732,0,16.091,10.732,16.091,10.732c9.417,15.984,26.167,13.41,32.182,10.729c0-5.357,2.348-13.473,5.359-16.09 c-23.43-2.636-42.931-16.091-42.931-42.914c0-26.822,5.386-32.181,10.75-37.554c-1.081-2.644-5.576-12.424,0.164-26.823 c0,0,10.542,0,21.273,16.091c5.315-5.314,21.454-5.359,26.821-5.359c5.352,0,21.5,0.044,26.813,5.359 c10.729-16.091,21.299-16.091,21.299-16.091c5.74,14.399,1.249,24.179,0.164,26.823c5.359,5.359,10.729,10.731,10.729,37.554 c0,26.823-19.475,40.27-42.911,42.914c3.021,2.617,5.358,11.85,5.358,16.09L170.925,222.189L170.925,222.189z"/></svg></div></a><a href="https://twitter.com/jobtalle" target="_blank"><div class="icon" title="Twitter"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="283.46px" height="283.46px" viewBox="0 0 283.46 283.46"><path class="icon-body" d="M141.73,0C63.451,0,0,63.451,0,141.73C0,220,63.451,283.46,141.73,283.46S283.46,220,283.46,141.73 C283.46,63.451,220.009,0,141.73,0z"/><path fill="#FFF" d="M161.449,78.713c-14.085,5.129-22.987,18.345-21.978,32.811l0.336,5.581l-5.634-0.682 c-20.506-2.622-38.426-11.507-53.645-26.433l-7.441-7.405l-1.904,5.465c-4.057,12.189-1.462,25.068,6.989,33.732  c4.509,4.783,3.49,5.465-4.278,2.622c-2.702-0.912-5.076-1.594-5.297-1.249c-0.788,0.797,1.914,11.162,4.057,15.271 c2.932,5.705,8.902,11.277,15.44,14.589l5.527,2.622l-6.546,0.098c-6.307,0-6.537,0.114-5.855,2.516 c2.25,7.405,11.152,15.271,21.073,18.69l6.989,2.392l-6.085,3.649c-9.018,5.254-19.612,8.212-30.207,8.424 c-5.076,0.115-9.248,0.567-9.248,0.913c0,1.134,13.756,7.512,21.747,10.027c24.005,7.405,52.52,4.208,73.93-8.433 c15.219-9,30.428-26.894,37.532-44.221c3.835-9.221,7.662-26.086,7.662-34.174c0-5.244,0.337-5.926,6.644-12.189 c3.721-3.649,7.211-7.636,7.893-8.77c1.134-2.17,1.01-2.17-4.73-0.23c-9.575,3.419-10.931,2.968-6.191-2.161 c3.49-3.65,7.662-10.258,7.662-12.189c0-0.336-1.691,0.23-3.605,1.249c-2.028,1.143-6.537,2.853-9.921,3.871l-6.085,1.94 l-5.52-3.774c-3.047-2.046-7.316-4.332-9.575-5.014C175.426,76.658,166.639,76.889,161.449,78.713z"/></svg></div></a><a rel="me" href="https://mastodon.gamedev.place/@jobtalle" target="_blank"><div class="icon" title="Mastodon"><svg viewBox="100 71.886 283.46 283.46" width="283.46" height="283.46" xmlns="http://www.w3.org/2000/svg"><g transform="matrix(1, 0, 0, 1, 100, 71.88604)"><path class="icon-body" d="M141.73,0C63.451,0,0,63.451,0,141.73C0,220,63.451,283.46,141.73,283.46S283.46,220,283.46,141.73 C283.46,63.451,220.009,0,141.73,0z"/></g><path fill="#FFF" d="M 321.979 235.324 C 319.488 248.139 299.668 262.165 276.905 264.883 C 265.034 266.3 253.347 267.602 240.884 267.03 C 220.503 266.096 204.421 262.165 204.421 262.165 C 204.421 264.149 204.543 266.038 204.788 267.806 C 207.437 287.92 224.733 289.125 241.116 289.686 C 257.651 290.252 272.374 285.61 272.374 285.61 L 273.053 300.558 C 273.053 300.558 261.487 306.768 240.884 307.911 C 229.523 308.535 215.416 307.625 198.986 303.276 C 163.35 293.844 157.222 255.858 156.284 217.316 C 155.998 205.873 156.174 195.082 156.174 186.058 C 156.174 146.646 181.997 135.093 181.997 135.093 C 195.017 129.114 217.359 126.599 240.586 126.41 L 241.156 126.41 C 264.383 126.599 286.74 129.114 299.759 135.093 C 299.759 135.093 325.581 146.646 325.581 186.058 C 325.581 186.058 325.905 215.135 321.979 235.324"/><path class="icon-body" d="M 295.123 189.115 L 295.123 236.835 L 276.216 236.835 L 276.216 190.517 C 276.216 180.754 272.109 175.798 263.891 175.798 C 254.805 175.798 250.251 181.677 250.251 193.301 L 250.251 218.654 L 231.457 218.654 L 231.457 193.301 C 231.457 181.677 226.903 175.798 217.817 175.798 C 209.6 175.798 205.491 180.754 205.491 190.517 L 205.491 236.835 L 186.586 236.835 L 186.586 189.115 C 186.586 179.362 189.069 171.612 194.057 165.878 C 199.201 160.144 205.937 157.204 214.299 157.204 C 223.974 157.204 231.3 160.923 236.145 168.361 L 240.854 176.255 L 245.564 168.361 C 250.408 160.923 257.733 157.204 267.41 157.204 C 275.77 157.204 282.507 160.144 287.652 165.878 C 292.638 171.612 295.123 179.362 295.123 189.115"/></svg></div></a><a href="https://www.linkedin.com/in/jobtalle" target="_blank"><div class="icon" title="LinkedIn"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="283.46px" height="283.46px" viewBox="0 0 283.46 283.46"><path class="icon-body" d="M141.73,0C63.451,0,0,63.451,0,141.73C0,220,63.451,283.46,141.73,283.46 c78.279,0,141.73-63.461,141.73-141.73C283.46,63.451,220.009,0,141.73,0z"/><path fill="#FFF" d="M215.199,203.223v-54.362c0-29.125-15.545-42.679-36.281-42.679c-16.732,0-24.229,9.204-28.398,15.661 v-13.438H119c0.417,8.902,0,94.817,0,94.817h31.517v-52.954c0-2.826,0.204-5.66,1.037-7.681c2.275-5.66,7.458-11.523,16.166-11.523 c11.408,0,15.971,8.689,15.971,21.438v50.729L215.199,203.223L215.199,203.223z M85.791,95.464c10.984,0,17.832-7.29,17.832-16.387 c-0.204-9.301-6.848-16.379-17.628-16.379c-10.78,0-17.822,7.078-17.822,16.379c0,9.106,6.838,16.387,17.424,16.387H85.791z M101.549,203.223v-94.817H70.041v94.817H101.549z"/></svg></div></a><a type="application/rss+xml" href="rss.xml" target="_blank"><div class="icon" title="RSS"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" width="283.46px" height="283.46px" viewBox="0 0 283.46 283.46"><path class="icon-body" d="M141.586,0C63.387,0,0,63.386,0,141.587c0,78.191,63.387,141.586,141.586,141.586 c78.2,0,141.587-63.396,141.587-141.586C283.173,63.386,219.787,0,141.586,0z"/><path fill="#FFF" d="M192.071,200.408h26.035c0-74.634-60.714-135.393-135.339-135.393v25.963 C143.029,90.978,192.071,140.074,192.071,200.408z M100.792,200.451c9.982,0,18.043-8.016,18.043-17.953 c0-9.886-8.061-17.993-18.043-17.993c-9.938,0-18.017,8.107-18.017,17.993C82.767,192.435,90.846,200.451,100.792,200.451z M146.064,200.416L146.064,200.416h26.061c0-49.289-40.096-89.385-89.368-89.385v25.954c16.902,0,32.786,6.601,44.75,18.584 C139.472,167.505,146.064,183.461,146.064,200.416z"/></svg></div></a></div></div></div><script src="lib/katex/katex.min.js"></script><script src="lib/katex/contrib/auto-render.min.js"></script><script>renderMathInElement(document.getElementById("content"),{delimiters:[{left:"$$",right:"$$",display:true},{left:"$",right:"$",display:false}]})</script></body></html>