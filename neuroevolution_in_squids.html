<!DOCTYPE html><html lang="en"><head><script async src="https://www.googletagmanager.com/gtag/js?id=UA-109031298-1"></script><script src="js/google.js"></script><title>Job Talle | Neuroevolution in squids</title><meta charset="UTF-8"><meta name="description" content="Artificial neural networks can be trained to perform certain tasks, but they can also be the product of simulated evolution. Evolved nervous systems are created according to a genetic blueprint. This article demonstrates squids swimming efficiently using tentacles controlled by an evolved neural network."/><meta name="keywords" content="software development, AI, algorithms, programming, Job Talle"/><meta name="author" content="Job Talle"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:locale" content="en_US"/><meta property="og:title" content="Neuroevolution in squids"/><meta property="og:url" content="https://jobtalle.com/neuroevolution_in_squids.html"/><meta property="og:description" content="Artificial neural networks can be trained to perform certain tasks, but they can also be the product of simulated evolution. Evolved nervous systems are created according to a genetic blueprint. This article demonstrates squids swimming efficiently using tentacles controlled by an evolved neural network."/><meta property="og:image" content="https://jobtalle.com/posts/2020_4_27/img/preview.jpg"/><meta property="twitter:image" content="https://jobtalle.com/posts/2020_4_27/img/preview.jpg"/><meta property="twitter:description" content="Artificial neural networks can be trained to perform certain tasks, but they can also be the product of simulated evolution. Evolved nervous systems are created according to a genetic blueprint. This article demonstrates squids swimming efficiently using tentacles controlled by an evolved neural network."/><meta property="twitter:site" content="jobtalle.com"/><meta property="twitter:card" content="summary"/><meta property="twitter:title" content="Neuroevolution in squids"/><link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet"/><link rel="shortcut icon" type="image/gif" href="img/favicon.gif"/><link rel="stylesheet" type="text/css" href="css/style.css"/><link rel="stylesheet" href="lib/katex/katex.min.css"></head><body><div id="container"><div id="menu-wrapper"><div id="menu-buttons"><a href="index.html"><div class="menu-button">Blog</div></a><a href="sketches.html"><div class="menu-button">Art</div></a><a href="about.html"><div class="menu-button">About</div></a><a href="contact.html"><div class="menu-button">Contact</div></a></div></div><div id="wrapper" class="container"><div id="header"><h1>Job Talle</h1><h2>On software development, AI & Algorithms</h2></div><div id="content"><h1>Neuroevolution in squids</h1><span class="date">27 Apr 2020</span><h2>Evolving a neural network</h2><p>Artificial neural networks mimic real biological nervous systems. They contain neurons and connections between them to transform input signals to meaningful output. In the field of machine learning, these networks are often initialized with random connections between the neurons, after which the network is <em>trained</em> until it behaves in a useful way. This works well enough, but many simple nervous systems found in animals work "out of the box"; no one teaches a fish to swim or butterflies to fly, even though their behaviour is produced by networks of neurons. Their nervous systems are not products of random initialization and subsequent training, but of <em>evolution</em>. After many generations, nature has produced an arrangement of cells and connections producing complex and useful behaviour.</p><p>To produce neural networks that produce non-learned behaviour, <em>neuroevolution</em> can be used. Evolutionary algorithms (like <a href="https://jobtalle.com/evolving_lindenmayer_systems.html" target="_blank">the one I used to evolve plants</a>) evolve a genetic code over time. The genetic code (a model for DNA) and the organism it represents starts out very simple, but over the course of many generations small mutations add beneficial complexity and functions promoting further propagation of these properties.</p><h2>Digital squids</h2><p>To demonstrate neuroevolution, I want to evolve digital squids. The squids have the following properties:</p><ul>    <li>Squids can have any number of tentacles with varying length.</li>    <li>The arms are controlled by a single output neuron, swinging them to one direction when low output is produced and in the opposite direction when high output is produced.</li>    <li>Squids have <em>heads</em>, the size of the head determines the amount of neurons it may have.</li>    <li>The mass of a squid is determined by its head size and the size of its tentacles.</li>    <li>Squids swim in simulated liquid filled with dots representing food. Touching these dots "eats" them, and the score of a squid is the number of dots it eats divided by its mass.</li></ul><p>These properties should through evolution produce squids that can swim efficiently through an environment, eating as much food as possible. Because they have mass as well, squid bodies must be effective: heavy bodies and big tentacles require more food, there must be a good reason to evolve them.</p><p>Because the squid can have varying properties (like head size and the configuration of its tentacles), these properties evolve as well. The <em>DNA</em> of a squid does not only contain the blueprint for its brain, but also its body plan.</p><h2>Spiking neural networks</h2><p>There are many different flavours of neural networks, <a href="https://towardsdatascience.com/the-mostly-complete-chart-of-neural-networks-explained-3fb6f2367464" target="_blank">this chart</a> contains a nice overview of some of them. The neural networks controlling the squids are in some aspects not like most well known networks:</p><ul>    <li>They do not have a traditional input to output structure. In fact, they do not need to contain input neurons at all. While many traditional neural networks transform or classify input in a way, the squid networks should produce behaviour.</li>    <li>The squid neurons need to work in <em>real-time</em>. There is no question to answer structure, the networks should function continually.</li>    <li>Because the networks evolve over time, they have no preset structure or size. The number of neurons and the number of connections between them varies according to their DNA, and changes over generations.</li></ul><p>A <em>spiking neural network</em> fits these requirements. They work over time, and were designed to mimic nature more closely. Just like real neurons, cells in a spiking neural network build up potential gathered from all its inputs over time, and slowly return to their "neutral" state when no input is received. Spiking neural networks do not need to adhere to a strict connectivity scheme. It does consist of a layer of input neurons, a layer of output neurons (controlling the tentacles in our case) and a number of neurons in between, called the <em>hidden layer</em>. Neurons in the hidden layer may be connected to each other in any way, but neurons may be disconnected as well.</p><figure title="The logistic function">    <img src="posts/2020_4_27/img/sigmoid.svg" width="400" height="300">    <figcaption>Figure 1: The logistic function.</figcaption></figure><p>The neurons in the nervous systems all have an <em>activation function</em>. This function determines the output value of the neuron based on the sum of its inputs. Neurons are connected by <em>axons</em>, which connect a source to a target neuron. The axon adds the source output value multiplied by the <em>axon weight</em> to the target activation. The activation function then determines the neuron output based on its activation. The chosen activation function in this simulation is the <em>logistic function:</em></p><p>$$\frac{1}{1+e^{-a}}$$</p><p>In this equation, $a$ is the activation of the neuron. Figure 1 shows a plot of the function. When $a=0$, the output is $0.5$; this is useful in this simulation, because the network must be able to produce behaviour even when no input is given. If the default output is non zero, some signals always flow through the system.</p><h2>Simulating evolution</h2><p>The simulation environment now consists of the following components:</p><ul>    <li>Any number of squids with varying body plans and a spiking neural network to control its limbs.</li>    <li>Food dots scattered around the environment.</li></ul><p>To start simulating evolution, the simulation simulates a fixed amount of time per generation. In my simulations, I chose a time period of 20 to 30 seconds. After this time, the best performing squid is picked and duplicated to form a new generation of squids. Before the next simulation takes place, all squids are mutated slightly.</p><div id="references"><a href="layered_voxel_rendering.html" title="Previously: Layered voxel rendering"><div class="post-reference post-reference-left">Layered voxel rendering</div></a></div></div><div id="footer">&copy Job Talle 2017 - 2020</div><div id="icons"><a href="contact.html"><div class="icon" id="icon-mail" title="Mail"></div></a><a href="https://www.github.com/jobtalle" target="_blank"><div class="icon" id="icon-github" title="Github"></div></a><a href="https://twitter.com/jobtalle" target="_blank"><div class="icon" id="icon-twitter" title="Twitter"></div></a><a href="https://www.linkedin.com/in/jobtalle" target="_blank"><div class="icon" id="icon-linkedin" title="LinkedIn"></div></a><a type="application/rss+xml" href="rss.xml" target="_blank"><div class="icon" id="icon-rss" title="RSS"></div></a></div></div></div><script src="lib/katex/katex.min.js"></script><script src="lib/katex/contrib/auto-render.min.js"></script><script>renderMathInElement(document.getElementById("content"),{delimiters:[{left:"$$",right:"$$",display:true},{left:"$",right:"$",display:false}]})</script></body></html>